"0","# devtools::install_github(""rfsaldanha/microdatasus"")"
"0",""
"0","# https://github.com/rfsaldanha/microdatasus"
"0",""
"0","# http://www2.datasus.gov.br/DATASUS/index.php?area=0901&item=1&acao=31&pad=31655"
"0",""
"0","# ftp://ftp.datasus.gov.br/dissemin/publicos/"
"0",""
"0","# ftp://ftp.datasus.gov.br/dissemin/publicos/CNES/200508_/Dados/"
"0",""
"0",""
"0",""
"0","### LER BASES DBC"
"0","# install.packages(""read.dbc"")"
"0","library(read.dbc)"
"0","library(microdatasus)"
"0","library(readr)"
"0","library(readxl)"
"0",""
"0",""
"0","leitos.cnes <- fetch_datasus(year_start = 2020, month_start = 2,"
"0","                              year_end = 2020, month_end = 2,"
"0","                              uf = ""RS"","
"0","                              information_system = ""CNES-LT"")"
"2","trying URL 'ftp://ftp.datasus.gov.br/dissemin/publicos/CNES/200508_/Dados/LT/LTRS2002.dbc'
"
"2","downloaded 35 KB

"
"0","leitos.cnes$CODLEITO = as.numeric(as.character(leitos.cnes$CODLEITO))"
"0","# municipio <- read_delim(""MUNICIPIO_BRASIL_201902/MUNICIPIO.csv"", "
"0","#     "";"", escape_double = FALSE, trim_ws = TRUE)"
"0","# names(municipio)[1] = ""CODUFMUN"""
"0","# names(municipio)[2] = ""MUNICIPIO"""
"0",""
"0","# leitos.cnes$CODLEITO = as.numeric(leitos.cnes$CODLEITO)"
"0",""
"0","x.pop <- na.omit(read_delim(""doc/populacao.csv"", "";"", skip = 3,locale = locale(encoding = ""ISO-8859-1"")))"
"2","Parsed with column specification:
cols(
  .default = col_character(),
  CODUFMUN = [32mcol_double()[39m,
  `2012` = [32mcol_double()[39m,
  `2013` = [32mcol_double()[39m,
  `2014` = [32mcol_double()[39m,
  `2015` = [32mcol_double()[39m,
  `2016` = [32mcol_double()[39m,
  `2017` = [32mcol_double()[39m,
  `2018` = [32mcol_double()[39m,
  `2019` = [32mcol_double()[39m
)
"
"2","See spec(...) for full column specifications.
"
"2","10 parsing failures.
 row      col expected actual                file
5571 CODUFMUN a double  Fonte 'doc/populacao.csv'
5572 CODUFMUN a double  Notas 'doc/populacao.csv'
5573 CODUFMUN a double  Total 'doc/populacao.csv'
5575 CODUFMUN a double  Para  'doc/populacao.csv'
5576 CODUFMUN a double  proje 'doc/populacao.csv'
.... ........ ........ ...... ...................
See problems(...) for more details.
"
"0","x.pop$CODUFMUN = as.factor(x.pop$CODUFMUN)"
"0",""
"0","x.hosp = read_csv(""doc/CADGERRS.csv"",locale = locale(encoding = ""ISO-8859-1""))"
"2","Parsed with column specification:
cols(
  .default = col_character(),
  LOGRADOU = [33mcol_logical()[39m,
  NUM_END = [33mcol_logical()[39m,
  COMPLEME = [33mcol_logical()[39m,
  BAIRRO = [33mcol_logical()[39m,
  COD_CEP = [33mcol_logical()[39m,
  TELEFONE = [33mcol_logical()[39m,
  FAX = [33mcol_logical()[39m,
  EMAIL = [33mcol_logical()[39m,
  CODUFMUN = [32mcol_double()[39m,
  EXCLUIDO = [32mcol_double()[39m,
  DATAINCL = [32mcol_double()[39m,
  DATAEXCL = [32mcol_double()[39m
)
"
"2","See spec(...) for full column specifications.
"
"0","# PASTA ""Tab_CMD"""
"0",""
"0","x.cid10 <- read_csv(""doc/CID10.csv"", "
"0","    locale = locale(encoding = ""ISO-8859-1""))"
"2","Parsed with column specification:
cols(
  CO_CID = [31mcol_character()[39m,
  DS_CID = [31mcol_character()[39m
)
"
"0","# com erro"
"0","# x.regsaude = read_delim(""rs_cnv/RS_REGSAUDE.csv"", "
"0","#     "";"", escape_double = FALSE, locale = locale(encoding = ""ISO-8859-1""), "
"0","#     trim_ws = TRUE)"
"0",""
"0","x.codleito = read_delim(""doc/CODLEITO.csv"", "
"0","    "";"", escape_double = FALSE, col_types = cols(CODLEITO = col_double()),locale = locale(encoding = ""ISO-8859-1""), "
"0","    trim_ws = TRUE)"
"0","# x.codleito$CODLEITO = as.factor(x.codleito$CODLEITO)"
"0",""
"0",""
"0",""
"0","#### CODIFICANDO A BASE"
"0","leitos.cnes$MUNICIPIO = x.pop[match(leitos.cnes$CODUFMUN, x.pop$CODUFMUN),""MUNICIPIO""]"
"0","# leitos.cnes$REGIAOSA = x.regsaude[match(leitos.cnes$REGSAUDE, x.regsaude$REGSAUDE),""var""] # com erro"
"0","leitos.cnes$HOSPITAL = x.hosp[match(leitos.cnes$CPF_CNPJ, x.hosp$CPF_CNPJ),""FANTASIA""]"
"0","leitos.cnes$LEITO = x.codleito[match(leitos.cnes$CODLEITO, x.codleito$CODLEITO),""LEITO""]"
"0",""
"0",""
"0","variables_names <- names(leitos.cnes)"
"0","if(""TPGESTAO"" %in% variables_names){"
"0","    leitos.cnes$TPGESTAO <- as.character(levels(leitos.cnes$TPGESTAO))[leitos.cnes$TPGESTAO]"
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""D""] <- ""DUPLA"""
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""E""] <- ""ESTADUAL"""
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""M""] <- ""MUNICIPAL"""
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""Z""] <- ""SEM GESTAO"""
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""S""] <- ""SEM GESTAO"""
"0","    leitos.cnes$TPGESTAO <- factor(leitos.cnes$TPGESTAO)"
"0","}"
"0",""
"0","if(""TPGESTAO"" %in% variables_names){"
"0","    leitos.cnes$TPGESTAO <- as.character(levels(leitos.cnes$TPGESTAO))[leitos.cnes$TPGESTAO]"
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""D""] <- ""DUPLA"""
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""E""] <- ""ESTADUAL"""
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""M""] <- ""MUNICIPAL"""
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""Z""] <- ""SEM GESTAO"""
"0","    leitos.cnes$TPGESTAO[leitos.cnes$TPGESTAO==""S""] <- ""SEM GESTAO"""
"0","    leitos.cnes$TPGESTAO <- factor(leitos.cnes$TPGESTAO)"
"0","  }"
"0",""
"0","if(""TP_LEITO"" %in% variables_names){"
"0","    leitos.cnes$TP_LEITO <- as.character(levels(leitos.cnes$TP_LEITO))[leitos.cnes$TP_LEITO]"
"0","    leitos.cnes$TP_LEITO[leitos.cnes$TP_LEITO==""1""] <- ""CIRURGICO"""
"0","    leitos.cnes$TP_LEITO[leitos.cnes$TP_LEITO==""2""] <- ""CLINICO"""
"0","    leitos.cnes$TP_LEITO[leitos.cnes$TP_LEITO==""3""] <- ""OBSTETRICOS"""
"0","    leitos.cnes$TP_LEITO[leitos.cnes$TP_LEITO==""4""] <- ""PEDIATRICOS"""
"0","    leitos.cnes$TP_LEITO[leitos.cnes$TP_LEITO==""5""] <- ""OUTRAS ESPECIALIDADES"""
"0","    leitos.cnes$TP_LEITO[leitos.cnes$TP_LEITO==""6""] <- ""HOSPITAL DIA"""
"0","    leitos.cnes$TP_LEITO[leitos.cnes$TP_LEITO==""7""] <- ""COMPLEMENTAR"""
"0","    leitos.cnes$TP_LEITO <- factor(leitos.cnes$TP_LEITO)"
"0","  }"
"0",""
"0",""
"0",""
"0","# dados_sih = fetch_datasus(year_start = 2020, month_start = 1,"
"0","#               year_end = 2020, month_end = 1,"
"0","#               uf = c(""RS""),"
"0","#               information_system = ""SIH-RD"")"
"0","# "
"0","# dados <- process_sih(data = dados_sih)"
"0",""
"0","# dados %>%"
"0","#   select(ESPEC, SEXO) %>%"
"0","#   group_by(ESPEC, SEXO) %>%"
"0","#   summarize(count = n()) %>%"
"0","#   group_by(ESPEC) %>%"
"0","#   mutate(perc = count/sum(count)*100) %>%"
"0","#   ggplot(aes(x = ESPEC, y = perc)) +"
"0","#     geom_col(aes(fill = SEXO)) +"
"0","#     xlab(""Especialidade"") + ylab(""Percentual"") + "
"0","#     labs(fill = ""Sexo"") +"
"0","#     ggtitle(""Especialidade da interna√ß√£o e sexo"") +"
"0","#     coord_flip()"
"0",""
"0","write.csv(leitos.cnes, ""leitos.cnes.csv"")"
